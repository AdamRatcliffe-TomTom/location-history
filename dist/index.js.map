{"version":3,"file":"index.js","sources":["../services/objects.js"],"sourcesContent":["import axios from \"axios\";\nimport rateLimit from \"axios-rate-limit\";\n\nconst QPS_LIMIT = process.env.QPS_LIMIT || 5;\nconst QPS_INTERVAL = process.env.QPS_INTERVAL || 1000;\nconst LOCATION_HISTORY_API_BASE_URL =\n  process.env.LOCATION_HISTORY_API_BASE_URL ||\n  \"https://api.tomtom.com/locationHistory/1\";\n\nconst http = rateLimit(axios.create(), {\n  maxRequests: QPS_LIMIT,\n  perMilliseconds: QPS_INTERVAL\n});\n\nconst addObject = async ({ apiKey, adminKey, object }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects?key=${apiKey}&adminKey=${adminKey}`;\n  const { data } = await http.post(url, object);\n  return data;\n};\n\nconst editObject = async ({ apiKey, adminKey, id, object }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}&adminKey=${adminKey}`;\n  const { data } = await http.put(url, object);\n  return data;\n};\n\nconst getObjects = async ({ apiKey }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects?key=${apiKey}`;\n  const { data } = await axios.get(url);\n  const objectDetailRequests = data.objects.map(({ id }) =>\n    getObjectDetail({ apiKey, id })\n  );\n  const objects = await Promise.all(objectDetailRequests);\n  return objects;\n};\n\nconst getObjectDetail = async ({ apiKey, id }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}`;\n  const { data } = await http.get(url);\n  return data;\n};\n\nconst deleteObject = async ({ apiKey, id }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}`;\n  const { data } = http.delete(url);\n  return data;\n};\n\nexport { addObject, editObject, getObjects, getObjectDetail, deleteObject };\n"],"names":["process","env","QPS_LIMIT","QPS_INTERVAL","LOCATION_HISTORY_API_BASE_URL","http","rateLimit","axios","create","maxRequests","perMilliseconds","getObjectDetail","_ref8","apiKey","id","get","data","e","Promise","reject","_ref","adminKey","object","post","then","_ref2","_ref10","resolve","_http$delete","editObject","_ref3","put","getObjects","_ref5","objectDetailRequests","_ref6","objects","map","_ref7","all"],"mappings":"uJAGkBA,QAAQC,IAAIC,WAAa,EACzBC,EAAGH,QAAQC,IAAIE,cAAgB,IAC3CC,EACJJ,QAAQC,IAAIG,+BACZ,2CAEQC,oBAAGC,QAAUC,EAAAA,QAAMC,SAAU,CACrCC,YAAaP,EACbQ,gBAAiBP,IAyBbQ,WAAeC,GAAA,IAAkBC,EAAAD,EAANC,OAAQC,EAAAA,EAAAA,OACoC,OACpDT,QAAAA,QAAAA,EAAKU,IADbX,EAAyCU,YAAAA,EAAUD,QAAAA,IAC1DG,KAAAA,SAAAA,GACR,SADQA,IACI,EACb,CAAA,MAAAC,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA,6BA1BcG,GAAA,IAAkBP,EAAAO,EAANP,OAAQQ,EAAAA,EAAAA,SAAUC,EAAMF,EAANE,OAAM,IACyC,uBACnEjB,EAAKkB,KADbnB,kBAA6CS,EAAM,aAAaQ,EACzCC,IAAOE,KAAA,SAAAC,GAC7C,OADQT,EAAAA,IACI,EAGd,CAFC,MAEDC,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA,gCAsBkBS,GAAA,IAAkBb,EAAAa,EAANb,OAAQC,EAAAA,EAAAA,OACpC,IACiBT,EAAAA,EAAW,OADbD,EAAyCU,YAAAA,EAAUD,QAAAA,GAElE,OAAAK,QAAAS,QADYC,EAAJZ,KAIV,CAFC,MAEDC,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA,qBA5BMY,SAAsBhB,GAAAA,IAAAA,IAAAA,OAAQQ,EAAQS,EAART,SAAUP,EAAAA,EAAAA,GAAIQ,EAAMQ,EAANR,OAAM,IAC0C,OAAAJ,QAAAS,QACzEtB,EAAK0B,IADb3B,cAAyCU,EAAE,QAAQD,EAAM,aAAaQ,EAChDC,IAA7BN,KAAAA,SAAAA,GACR,OADQA,EAAAA,IACI,GACb,iFAEKgB,gBAA4BnB,EAAAoB,EAANpB,OAAM,IACqC,OAC9CN,QAAAA,QAAAA,EAAAA,QAAMQ,IADdX,kBAA6CS,yBAElCqB,EADdC,EAAJnB,KAC0BoB,QAAQC,IAAI,SAAAC,GAC5C3B,OAAAA,EAAgB,CAAEE,OAAAA,EAAQC,GADqBA,EAAAA,IAChB,GAC/B,OACoBI,QAAAA,QAAAA,QAAQqB,IAAIL,KAEnC,CAAA,MAAAjB,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA"}