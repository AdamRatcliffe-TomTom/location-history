{"version":3,"file":"index.modle.js","sources":["../services/objects.js"],"sourcesContent":["import axios from \"axios\";\nimport valvelet from \"valvelet\";\n\nconst QPS_LIMIT = process.env.QPS_LIMIT || 5;\nconst QPS_INTERVAL = process.env.QPS_INTERVAL || 1000;\nconst LOCATION_HISTORY_API_BASE_URL =\n  process.env.LOCATION_HISTORY_API_BASE_URL ||\n  \"https://api.tomtom.com/locationHistory/1\";\n\nconst addObject = async ({ apiKey, adminKey, object }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects?key=${apiKey}&adminKey=${adminKey}`;\n  const { data } = await axios.post(url, object);\n  return data;\n};\n\nconst editObject = async ({ apiKey, adminKey, id, object }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}&adminKey=${adminKey}`;\n  const { data } = await axios.put(url, object);\n  return data;\n};\n\nconst getObjects = async ({ apiKey }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects?key=${apiKey}`;\n  const { data } = await axios.get(url);\n  const objectDetailRequests = data.objects.map(({ id }) =>\n    getObjectDetail({ apiKey, id })\n  );\n  const objects = await Promise.all(objectDetailRequests);\n  return objects;\n};\n\nconst getObjectDetail = valvelet(\n  async ({ apiKey, id }) => {\n    const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}`;\n    const { data } = await axios.get(url);\n    return data;\n  },\n  QPS_LIMIT,\n  QPS_INTERVAL\n);\n\nconst deleteObject = async ({ apiKey, id }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}`;\n  const { data } = axios.delete(url);\n  return data;\n};\n\nexport { addObject, editObject, getObjects, getObjectDetail, deleteObject };\n"],"names":["QPS_LIMIT","process","env","QPS_INTERVAL","LOCATION_HISTORY_API_BASE_URL","addObject","_ref","apiKey","adminKey","object","axios","post","data","e","Promise","reject","editObject","_ref3","id","put","then","_ref4","getObjects","_ref5","get","objectDetailRequests","objects","map","getObjectDetail","all","valvelet","_ref8","_ref9","deleteObject","_ref10","resolve"],"mappings":"6CAGA,IAAeA,EAAGC,QAAQC,IAAIF,WAAa,EACzBG,EAAGF,QAAQC,IAAIC,cAAgB,IAC3CC,EACJH,QAAQC,IAAIE,+BACZ,2CAEaC,EAAA,SAAAC,GAAA,MAAYC,EAAAA,OAAQC,IAAAA,SAAUC,EAAMH,EAANG,OAAM,IACyC,OACnEC,QAAAA,QAAAA,EAAMC,KADdP,EAA6CG,gBAAAA,eAAmBC,EACxCC,IAA/BG,KAAAA,SAAAA,GACR,SADQA,IACI,EACb,CAAA,MAAAC,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA,EAEKG,WAAUC,GAAA,IAAkBV,EAAAU,EAANV,OAAQC,EAAQS,EAART,SAAUU,EAAAA,EAAAA,GAAIT,EAAMQ,EAANR,OAAM,IAC0C,OACzEC,QAAAA,QAAAA,EAAMS,IADdf,EAAyCc,YAAAA,EAAUX,QAAAA,eAAmBC,EAC/CC,IAAOW,KAAA,SAAAC,GAC7C,OADYA,EAAJT,IACI,EACb,CAAA,MAAAC,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA,EAEKS,WAAUC,GAAA,IAAkBhB,EAAAgB,EAANhB,OAAa,IAC8B,OAC9CG,QAAAA,QAAAA,EAAMc,IADdpB,EAA6CG,gBAAAA,IACpDK,KAAAA,SAAAA,GAAAA,IACFa,IADEb,KAC0Bc,QAAQC,IAAI,SAAGT,GAAE,OAClCU,EAAC,CAAErB,OAAAA,EAAQW,KADqBA,IAChB,GAC/B,OACoBJ,QAAAA,QAAAA,QAAQe,IAAIJ,KAEnC,CAAA,MAAAZ,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA,EAEKe,EAAkBE,EACbvB,SAAAA,GAAAA,IAAAA,IAAAA,OAAQW,EAAEa,EAAFb,GAAS,IACmD,OACpDR,QAAAA,QAAAA,EAAMc,IADdpB,EAA6B,YAAYc,EAAE,QAAQX,qBAElE,OADYyB,EAAJpB,IACI,EACb,CAAA,MAAAC,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA,EACDb,EACAG,GAGI8B,EAAAA,gBAA8B1B,EAAA2B,EAAN3B,OAAQW,EAAAA,EAAAA,GAAS,IAC7C,MACiBR,EAAK,OADPN,cAAyCc,EAAE,QAAQX,GAElE,OAAAO,QAAAqB,QADQvB,EAAAA,KAIV,CAFC,MAEDC,GAAA,OAAAC,QAAAC,OAAAF,EAAA,CAAA"}