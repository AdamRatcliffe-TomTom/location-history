{"version":3,"file":"index.modern.mjs","sources":["../http.js","../services/objects.js","../services/position_history.js"],"sourcesContent":["import axios from \"axios\";\nimport rateLimit from \"axios-rate-limit\";\n\nconst QPS_LIMIT = process.env.QPS_LIMIT || 5;\nconst QPS_INTERVAL = process.env.QPS_INTERVAL || 1000;\n\nconst http = rateLimit(axios.create(), {\n  maxRequests: QPS_LIMIT,\n  perMilliseconds: QPS_INTERVAL\n});\n\nexport default http;\n","import http from \"../http\";\n\nconst LOCATION_HISTORY_API_BASE_URL =\n  process.env.LOCATION_HISTORY_API_BASE_URL ||\n  \"https://api.tomtom.com/locationHistory/1\";\n\nconst addObject = async ({ apiKey, adminKey, object }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects?key=${apiKey}&adminKey=${adminKey}`;\n  const { data } = await http.post(url, object);\n  return data;\n};\n\nconst editObject = async ({ apiKey, adminKey, id, object }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}&adminKey=${adminKey}`;\n  const { data } = await http.put(url, object);\n  return data;\n};\n\nconst getObjects = async ({ apiKey }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects?key=${apiKey}`;\n  const { data } = await axios.get(url);\n  const objectDetailRequests = data.objects.map(({ id }) =>\n    getObjectDetail({ apiKey, id })\n  );\n  const objects = await Promise.all(objectDetailRequests);\n  return objects;\n};\n\nconst getObjectDetail = async ({ apiKey, id }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}`;\n  const { data } = await http.get(url);\n  return data;\n};\n\nconst deleteObject = async ({ apiKey, id }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/objects/${id}?key=${apiKey}`;\n  const { data } = http.delete(url);\n  return data;\n};\n\nexport { addObject, editObject, getObjects, getObjectDetail, deleteObject };\n","import http from \"../http\";\n\nconst LOCATION_HISTORY_API_BASE_URL =\n  process.env.LOCATION_HISTORY_API_BASE_URL ||\n  \"https://api.tomtom.com/locationHistory/1\";\n\nconst sendPosition = async ({ apiKey, longitude, latitude, altitude }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/history/positions?key=${apiKey}`;\n  const coordinates = [\n    longitude,\n    latitude,\n    ...(Boolean(altitude) ? [altitude] : [])\n  ];\n  const position = {\n    type: \"Feature\",\n    geometry: {\n      type: \"Point\",\n      coordinates\n    }\n  };\n  const { data } = await http.post(url, position);\n  return data;\n};\n\nconst lastPosition = async ({ apiKey, objectId }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/history/position/${objectId}?key=${apiKey}`;\n  const { data } = await http.get(url);\n  return data;\n};\n\nconst positionHistory = async ({\n  apiKey,\n  adminKey,\n  objectId,\n  from,\n  to,\n  maxResults,\n  pageNumber\n}) => {\n  let url = `${LOCATION_HISTORY_API_BASE_URL}/history/positions/${objectId}?key=${apiKey}&adminKey=${adminKey}&from=${from}`;\n  if (to) url += `&to=${to}`;\n  if (maxResults) url += `&maxResults=${maxResults}`;\n  if (pageNumber) url += `&pageNumber=${pageNumber}`;\n\n  const { data } = http.get(url);\n  return data;\n};\n\nconst clearPositionHistory = async ({ apiKey, adminKey }) => {\n  const url = `${LOCATION_HISTORY_API_BASE_URL}/history/position?key=${apiKey}&adminKey=${adminKey}`;\n  const { data } = http.delete(url);\n  return data;\n};\n\nexport { sendPosition, lastPosition, positionHistory, clearPositionHistory };\n"],"names":["QPS_LIMIT","process","env","QPS_INTERVAL","http","rateLimit","axios","create","maxRequests","perMilliseconds","LOCATION_HISTORY_API_BASE_URL","addObject","async","apiKey","adminKey","object","url","data","post","editObject","id","put","getObjects","get","objectDetailRequests","objects","map","getObjectDetail","Promise","all","deleteObject","delete","sendPosition","longitude","latitude","altitude","position","type","geometry","coordinates","Boolean","lastPosition","objectId","positionHistory","from","to","maxResults","pageNumber","clearPositionHistory"],"mappings":"qDAGA,MAAeA,EAAGC,QAAQC,IAAIF,WAAa,EACrCG,EAAeF,QAAQC,IAAIC,cAAgB,IAE3CC,EAAOC,EAAUC,EAAMC,SAAU,CACrCC,YAAaR,EACbS,gBAAiBN,ICNbO,EACJT,QAAQC,IAAIQ,+BACZ,2CAEaC,EAAGC,OAASC,SAAQC,WAAUC,aAC3C,MAASC,EAAI,GAAEN,iBAA6CG,cAAmBC,KACzEG,KAAEA,SAAmBb,EAACc,KAAKF,EAAKD,GACtC,OACFE,GAEgBE,EAAGP,OAASC,SAAQC,WAAUM,KAAIL,aAChD,MAASC,EAAI,GAAEN,aAAyCU,SAAUP,cAAmBC,KAC/EG,KAAEA,SAAmBb,EAACiB,IAAIL,EAAKD,GACrC,OAAOE,GAGHK,EAAaV,OAASC,aAC1B,MAASG,EAAI,GAAEN,iBAA6CG,KACtDI,KAAEA,SAAeX,MAAMiB,IAAIP,GAC3BQ,EAAuBP,EAAKQ,QAAQC,IAAI,EAAGN,QAC/CO,EAAgB,CAAEd,SAAQO,QAG5B,aADsBQ,QAAQC,IAAIL,EAC3BC,EAGHE,EAAkBf,OAASC,SAAQO,SACvC,MAASJ,EAAI,GAAEN,aAAyCU,SAAUP,KAC5DI,KAAEA,SAAeb,EAAKmB,IAAIP,GAChC,OAAOC,GAGHa,EAAelB,OAASC,SAAQO,SACpC,QAAa,GAAEV,aAAyCU,SAAUP,KAC5DI,KAAEA,GAASb,EAAK2B,OAAOf,GAC7B,OAAOC,GCnCHP,EACJT,QAAQC,IAAIQ,+BACZ,2CAEgBsB,EAAGpB,OAASC,SAAQoB,YAAWC,WAAUC,eACzD,MAASnB,EAAI,GAAEN,2BAAuDG,IAMxDuB,EAAG,CACfC,KAAM,UACNC,SAAU,CACRD,KAAM,QACNE,YATgB,CAClBN,EACAC,KACIM,QAAQL,GAAY,CAACA,GAAY,OASjClB,KAAEA,SAAmBb,EAACc,KAAKF,EAAKoB,GACtC,OAAOnB,GAGHwB,EAAe7B,OAASC,SAAQ6B,eACpC,QAAa,GAAEhC,sBAAkDgC,SAAgB7B,KAC3EI,KAAEA,SAAeb,EAAKmB,IAAIP,GAChC,OACFC,GAEqB0B,EAAG/B,OACtBC,SACAC,WACA4B,WACAE,OACAC,KACAC,aACAC,iBAEA,IAAI/B,EAAO,GAAEN,uBAAmDgC,SAAgB7B,cAAmBC,UAAiB8B,IAChHC,IAAI7B,GAAQ,OAAM6B,KAClBC,IAAY9B,GAAQ,eAAc8B,KAClCC,IAAY/B,GAAQ,eAAc+B,KAEtC,MAAM9B,KAAEA,GAASb,EAAKmB,IAAIP,GAC1B,OAAOC,GAGH+B,EAAuBpC,OAASC,SAAQC,eAC5C,MAAME,EAAO,GAAEN,0BAAsDG,cAAmBC,KAClFG,KAAEA,GAASb,EAAK2B,OAAOf,GAC7B,OAAOC"}